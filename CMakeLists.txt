CMAKE_MINIMUM_REQUIRED(VERSION 3.7.00)
ENABLE_TESTING()
PROJECT(Proto_v1)

# Project Info
SET(APPLICATION_NAME "Proto_v1")
SET(APPLICATION_CODENAME "${PROJECT_NAME}")
SET(APPLICATION_COPYRIGHT_YEARS "2020")
SET(APPLICATION_VERSION_MAJOR 0)
SET(APPLICATION_VERSION_MINOR 1)
SET(APPLICATION_VERSION_PATCH 0)
SET(APPLICATION_VERSION_TYPE SNAPSHOT)
SET(APPLICATION_VERSION_STRING "${APPLICATION_VERSION_MAJOR}.${APPLICATION_VERSION_MINOR}.${APPLICATION_VERSION_PATCH}-${APPLICATION_VERSION_TYPE}")
SET(APPLICATION_VENDOR_ID "")
SET(APPLICATION_VENDOR_NAME "")
SET(APPLICATION_VENDOR_URL "")
SET(APPLICATION_ID "${APPLICATION_VENDOR_ID}.${PROJECT_NAME}")

## Configure Files
FILE(GLOB_RECURSE CONFIGINPUTS1 include/*.h.in.cmake)
FILE(GLOB_RECURSE CONFIGINPUTS2 src/*.h.in.cmake)
LIST(APPEND CONFIGINPUTS "${CONFIGINPUTS1}")
LIST(APPEND CONFIGINPUTS "${CONFIGINPUTS2}")
FOREACH(CONFIGINPUT ${CONFIGINPUTS})
  STRING(REPLACE ".h.in.cmake" ".h" CONFIGOUTPUT1 "${CONFIGINPUT}")
        CONFIGURE_FILE("${CONFIGINPUT}" "${CONFIGOUTPUT1}")
ENDFOREACH(CONFIGINPUT ${CONFIGINPUTS})

## Project Output Paths
SET(MAINFOLDER ${PROJECT_SOURCE_DIR})

## Project Search Paths
LIST(APPEND CMAKE_PREFIX_PATH "${MAINFOLDER}")
LIST(APPEND CMAKE_PREFIX_PATH "${MAINFOLDER}/tools")
SET(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${MAINFOLDER}/cmake")

## Use 0 for debugging, 1 for release
SET(CMAKE_VERBOSE_MAKEFILE 0)
set(CMAKE_EXPORT_COMPILE_COMMANDS 1)


## Add Code Coverage Target for Supported Compilers
IF( ( CMAKE_CXX_COMPILER_ID MATCHES "Clang" OR
    CMAKE_CXX_COMPILER_ID MATCHES "GNU") AND
    NOT WIN32 )
    INCLUDE(CodeCoverage)
    SET(GCOV_LIBRARY gcov)
ENDIF()

#Project dependecies
if (EXISTS ${CMAKE_BINARY_DIR}/conanfile.txt)
	if (EXISTS ${CMAKE_BINARY_DIR}/conanbuildinfo.cmake)
	    include(${CMAKE_BINARY_DIR}/conanbuildinfo.cmake)
	    conan_basic_setup()
	else ()
	    message(WARNING "The file conanbuildinfo.cmake doesn't exist, you have to run conan install first")
	endif ()
endif()

## Project Sources
FILE(GLOB_RECURSE TEST_SRCS ${MAINFOLDER}/tests/*.cpp ${MAINFOLDER}/tests/*.h)

find_package(Qt6 REQUIRED COMPONENTS Core Qml Test Widgets Quick)
add_definitions(-D_VARIADIC_MAX=10)
add_subdirectory(docs)
add_subdirectory(src)
add_subdirectory(tests)
